# 哈工大操作系统-L16进程同步与信号量

[TOC]

多进程同步如何合理有序？

## 1.等待--实现进程同步的重要一步

- 需要让“进程走走停停”来保证多进程合作的合理有序，这就是进程同步
- 分析什么时候停和什么时候走是非常关键的。

## 2.生产者消费者问题

### 2.1初步设想--通过发信号解决问题

<img src="E:\AAAAAAAuniPPT\4_1PPT\CSclass-OS(git)\学习笔记\${图片}\image-20210807113137895.png" alt="image-20210807113137895" style="zoom:50%;" />

- 单纯依靠发信号是不足以解决问题的。
- **还需要多一个量来判断是否需要发信号，由此引出信号量**

### 2.2引出信号量

<img src="E:\AAAAAAAuniPPT\4_1PPT\CSclass-OS(git)\学习笔记\${图片}\image-20210807113421060.png" alt="image-20210807113421060" style="zoom:50%;" />

<img src="E:\AAAAAAAuniPPT\4_1PPT\CSclass-OS(git)\学习笔记\${图片}\image-20210807113755664.png" alt="image-20210807113755664" style="zoom:50%;" />

- 信号量--记录一些信息的量，由这些信息决定是睡眠还是唤醒。
- 上述感觉反了，生产的资源应该永远不会超过可用资源的个数。
  - <font color=blue>下面是我对这个模型的理解</font>
  - 如果我们用生产者消费者构建访问共享资源的模型。
  - 可用的资源即为共享的资源
  - 消费者跟生产者是相对的，每个进程都能执行消费和生产的动作
  - 当进程想要访问资源的时候，就为消费者，如果有可用的资源才可消费(访问)
  - 当进程访问资源结束的时候，释放资源，即为生产者(因此，生产者不会生产多于可用资源个数的资源)

### 2.3信号量的定义

<img src="E:\AAAAAAAuniPPT\4_1PPT\CSclass-OS(git)\学习笔记\${图片}\image-20210807115300342.png" alt="image-20210807115300342" style="zoom:50%;" />

- semaphore 	英 [ˈseməfɔː(r)] 
  - n. 	信号标; 旗语; 信号量
  - v. 	打旗语
- 信号量由两部分构成 value 和queue。
  - queue是一个等待队列
  - value为负，当前无可用资源，且有多个进程在等待
  - value为0，当前无可用资源，但无进程等待资源
  - value为正，说明有可用资源，且无进程在等待资源
- 上面这个代码传参数应该用引用或者指针才行...

<img src="E:\AAAAAAAuniPPT\4_1PPT\CSclass-OS(git)\学习笔记\${图片}\image-20210807120023390.png" alt="image-20210807120023390" style="zoom:50%;" />
这个互斥信号量，讲的不够全面，还是看电子科大的课好了